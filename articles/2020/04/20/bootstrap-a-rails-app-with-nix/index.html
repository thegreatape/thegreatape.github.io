<!DOCTYPE html>
<html>
<head><meta content='text/html; charset=UTF-8' http-equiv='Content-Type'><meta charset='utf-8'><meta content='width=device-width, initial-scale=1' name='viewport'><title>Bootstrapping a Rails app with Nix - Thomas Mayfield</title><meta content='Thomas Mayfield' name='author'><meta content='Bootstrapping a Rails app with Nix - Thomas Mayfield' name='description'><meta content='' name='keywords'><!-- Twitter Cards --><meta content='summary' name='twitter:card'><meta content='/images/birds.jpg' name='twitter:image'><meta content='Bootstrapping a Rails app with Nix - Thomas Mayfield' name='twitter:title'><meta content='@thegreatape' name='twitter:creator'><!-- Open Graph --><meta content='en_US' property='og:locale'><meta content='article' property='og:type'><meta content='Bootstrapping a Rails app with Nix - Thomas Mayfield' property='og:title'><meta content='/' property='og:url'><meta content='Thomas Mayfield' property='og:site_name'><link href='/assets/css/styles.css' rel='stylesheet'><script src='/assets/js/bundle.js'></script><script src='https://use.fontawesome.com/releases/v5.3.1/js/all.js'></script><link href='/feed.xml' rel='alternate' title='Thomas Mayfield' type='application/atom+xml'></head>
<body class='post '>
<nav aria-label='main navigation' class='navbar has-shadow is-primary' role='navigation'><div class='container'><div class='navbar-brand'><div class='navbar-item'><div class='title is-2'>Thomas Mayfield</div></div><a aria-expanded='false' aria-label='menu' class='navbar-burger burger' data-target='navbar-menu' role='button'><span aria-hidden='true'></span><span aria-hidden='true'></span><span aria-hidden='true'></span></a></div><div class='navbar-menu' id='navbar-menu'><div class='navbar-start'><a class='navbar-item' href='/'>Home</a><a class='navbar-item' href='/reading'>Reading</a><a class='navbar-item' href='/code'>Code</a><a class='navbar-item' href='/about'>About Me</a></div></div></div></nav>
<section class='section'>
<div class='container'>
<h2 class='title is-2'>Bootstrapping a Rails app with Nix</h2>

<div class='date subtitle is-5'>April 20, 2020</div>

<div class='content'><p>We’ve started using <a href="https://nixos.org/nix/">Nix</a> at work for our development environments, and I wanted to spend some time learning how to use it for my own projects. So I set up a <a href="https://github.com/thegreatape/nix-rails-template">minimal template for a new Rails app</a> to help me learn.</p>

<p>I’m not going to go into depth about how Nix works: I’d rather highlight why I think it’s cool and worth learning with a template to get running and experiment on. Jean-Philippe Cugnet wrote <a href="https://ejpcmac.net/blog/about-using-nix-in-my-development-workflow/">a great in-depth article here</a> about how Nix works and how to use it as a general-purpose development environment manager, so check out his writing if you want to dive in deep.</p>

<p>To me, Nix is interesting for development environments because of two things:</p>

<ul>
  <li>
    <p><strong>Dependency Isolation</strong>: Nix allows multiple versions of a package to co-exist on the same computer. Ever tried running multiple apps on your laptop? Maybe one requires an older version of libxml2, another a specific revision of postgres. Huge pain to deal with, and what can be a huge time sink to manage by hand is removed entirely by Nix’s dependency resolution. Think of it like <code class="highlighter-rouge">chroot</code> with package management superpowers.</p>
  </li>
  <li>
    <p><strong>Runs Natively</strong>: Lots of people use Docker to solve the dependecy isolation issue. But I work on a Mac, so Docker means running a linux VM and having to deal with slower filesystem performance between the native host and the containers running on the VM. Nix involves no virtualization, so there’s no speed penalty and all my native tools are available.</p>
  </li>
</ul>

<p>I use Rails by default for most of my web project work, so I made a <a href="https://github.com/thegreatape/nix-rails-template">small Rails app generation template that uses Nix</a>. The specific instructions are on the <a href="https://github.com/thegreatape/nix-rails-template/blob/master/README.md">README</a>, but in short: it sets up an isolated Ruby and Postgres install, configures a Rails app to use them, then gives you a shell with those dependencies available. From there, you can run the database (using <a href="https://github.com/DarthSim/overmind">overmind</a> for process management) and all your normal Rails commands inside that shell. Enjoy!</p>
</div>
</div>
</section>
</body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28952322-1', 'thegreata.pe');
  ga('send', 'pageview');

</script>

</html>
